var myApp=angular.module("myApp",["phantasm"]),northwindUri="uri:http://ultrastructure.me/ontology/com.chiralbehaviors/demo/northwind/v1";myApp.config(["$httpProvider",function(t){t.defaults.useXDomain=!0,delete t.defaults.headers.common["X-Requested-With"]}]),myApp.service("Customers",["WorkspacePhantasm",function(t){this.instances=function(){return t.facetInstances(northwindUri,"Agency","kernel|IsA","Customer")},this.instance=function(e){return t.facetInstance(northwindUri,"Agency","kernel|IsA","Customer",e)}}]),myApp.filter("sumByKey",function(){return function(t,e){if("undefined"==typeof t||"undefined"==typeof e)return 0;for(var r=0,n=t.length-1;n>=0;n--)r+=parseInt(t[n][e]);return r}}),myApp.filter("customSum",function(){return function(listOfProducts,key){var total=0;return angular.forEach(listOfProducts,function(product){total+=eval("product."+key)}),total}}),myApp.filter("countItemsInOrder",function(){return function(t){var e=0;return angular.forEach(t,function(t){e+=t.quantity}),e}}),myApp.filter("orderTotal",function(){return function(t){var e=0;return angular.forEach(t,function(t){e+=t.quantity*t["unit price"]}),e}}),myApp.controller("MasterDetailCtrl",["$scope","Customers",function(t,e){t.listOfCustomers=null,t.selectedCustomer=null;var r=[";a=Customer Name"];e.instances().get({select:r}).then(function(e){t.listOfCustomers=e["@graph"],t.listOfCustomers.length>0&&(t.selectedCustomer=t.listOfCustomers[0]["@id"],t.loadOrders())}),t.selectCustomer=function(e){t.selectedCustomer=e["@id"],t.loadOrders()},t.loadOrders=function(){t.listOfOrders=null;var r=";a=name;a=Required Date;a=Order Date;a=Ship Date",n=";a=unit price;a=quantity;a=discount;a=tax rate/product/name",u=["orders"+r+"/itemDetails"+n];e.instance(t.selectedCustomer).get({select:u}).then(function(e){t.listOfOrders=e.orders})}}]);